{% extends 'base.html' %}
{% block title %}{{ video.title }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <h3>{{ video.title }}</h3>
  <p><small class="text-muted">Uploaded by: {{ video.owner.username }} | Duration: {{ video.duration }}</small></p>
  {# Use embed_url passed from backend #}
  {% if embed_url %}
    <iframe width="100%" height="400" src="{{ embed_url }}" frameborder="0" allowfullscreen></iframe>
  {% else %}
    <div class="alert alert-warning">Invalid or unsupported YouTube URL: {{ video.url }}</div>
  {% endif %}
  <p class="mt-3">{{ video.description }}</p>

  {% if current_user.is_authenticated and video.user_id == current_user.id %}
  <a href="{{ url_for('main.edit_video', id=video.id) }}" class="btn btn-warning">Edit</a>
  <form action="{{ url_for('main.delete_video', id=video.id) }}" method="POST" class="d-inline">
      <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this video?');">Delete</button>
    </form>
  {% endif %}
  <a href="{{ url_for('main.index') }}" class="btn btn-secondary">Back to all videos</a>
</div>
{% endblock %}
